# Project Plan: SSYK Occupation Classifier MCP Server

## Goal
Create an MCP server that classifies occupations into SSYK codes and fetches income statistics from SCB.

## Status
- [x] **Project Initialization**
    - [x] Folder structure created (`data/`, `src/`, `notebooks/`)
    - [x] `pyproject.toml` created with dependencies
- [x] **Data Ingestion**
    - [x] `src/ssyk_mcp/ingestion.py` implemented
    - [x] Downloads SSYK JSON
    - [x] Extracts Level 4 codes
    - [x] Generates OpenAI embeddings
    - [x] Saves to Parquet
- [x] **SCB API Client**
    - [x] `src/ssyk_mcp/scb_api.py` implemented
    - [x] Dynamic metadata fetching for codes
    - [x] Fetches Median, P25, P75 salaries
- [x] **Search Engine**
    - [x] `src/ssyk_mcp/search.py` implemented
    - [x] BM25 Indexing
    - [x] Vector Search (Cosine Similarity)
    - [x] Hybrid Fusion (Weighted Average)
- [x] **MCP Server**
    - [x] `src/ssyk_mcp/server.py` implemented using `FastMCP`
    - [x] Tools exposed: `classify_occupation`, `get_income_statistics`
- [x] **Execution**
    - [x] `dev.py` created for easy running

## Next Steps
1.  **Run Ingestion**: Execute `python src/ssyk_mcp/ingestion.py` to populate the data.
2.  **Test Server**: Run `python dev.py` and connect an MCP client (like Claude Desktop or a debugger).
3.  **Refinement**:
    - Tune search weights (currently 0.3 BM25 / 0.7 Vector).
    - Add caching for SCB API calls.
    - Improve error handling.

## Usage
1.  Install dependencies: `uv sync` (or `pip install -e .`)
2.  Set `OPENAI_API_KEY` in `.env`.
3.  Run ingestion: `python src/ssyk_mcp/ingestion.py`
4.  Run server: `python dev.py`
